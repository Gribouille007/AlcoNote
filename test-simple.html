<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Simple</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
        }
        .test-result {
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
        }
        .success { background-color: #d4edda; color: #155724; }
        .error { background-color: #f8d7da; color: #721c24; }
        .info { background-color: #d1ecf1; color: #0c5460; }
        button {
            padding: 10px 20px;
            margin: 5px;
            font-size: 16px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <h1>Test de Fonctionnement HTTP vs File://</h1>
    
    <div id="protocol-info" class="test-result info">
        <strong>Protocole:</strong> <span id="current-protocol"></span>
    </div>
    
    <div id="js-test" class="test-result">
        <strong>JavaScript:</strong> <span id="js-status">En cours...</span>
    </div>
    
    <div id="external-libs" class="test-result">
        <strong>Bibliothèques externes:</strong> <span id="libs-status">En cours...</span>
    </div>
    
    <button onclick="testButton()">Test Interaction</button>
    
    <div id="interaction-test" class="test-result">
        <strong>Interactions:</strong> <span id="interaction-status">Cliquez sur le bouton</span>
    </div>

    <script>
        // Test du protocole
        document.getElementById('current-protocol').textContent = window.location.protocol;
        
        // Test JavaScript de base
        try {
            document.getElementById('js-status').textContent = 'Fonctionnel';
            document.getElementById('js-test').className = 'test-result success';
        } catch (e) {
            document.getElementById('js-status').textContent = 'Erreur: ' + e.message;
            document.getElementById('js-test').className = 'test-result error';
        }
        
        // Test des bibliothèques externes
        let libsLoaded = 0;
        let libsExpected = 4;
        
        function checkLib(name, condition) {
            if (condition) {
                libsLoaded++;
                console.log(name + ' chargée');
            } else {
                console.error(name + ' non chargée');
            }
            
            if (libsLoaded === libsExpected) {
                document.getElementById('libs-status').textContent = 'Toutes chargées (' + libsLoaded + '/' + libsExpected + ')';
                document.getElementById('external-libs').className = 'test-result success';
            } else {
                document.getElementById('libs-status').textContent = 'Partiellement chargées (' + libsLoaded + '/' + libsExpected + ')';
                document.getElementById('external-libs').className = 'test-result error';
            }
        }
        
        // Vérifier Chart.js
        setTimeout(() => checkLib('Chart.js', typeof Chart !== 'undefined'), 1000);
        
        // Vérifier Dexie
        setTimeout(() => checkLib('Dexie', typeof Dexie !== 'undefined'), 1000);
        
        // Vérifier Quagga
        setTimeout(() => checkLib('Quagga', typeof Quagga !== 'undefined'), 1000);
        
        // Vérifier Leaflet
        setTimeout(() => checkLib('Leaflet', typeof L !== 'undefined'), 1000);
        
        function testButton() {
            document.getElementById('interaction-status').textContent = 'Bouton cliqué avec succès!';
            document.getElementById('interaction-test').className = 'test-result success';
        }
    </script>
    
    <!-- Bibliothèques externes comme dans index.html -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/quagga@0.12.1/dist/quagga.min.js"></script>
    <script src="https://unpkg.com/dexie@3.2.4/dist/dexie.js"></script>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
</body>
</html>
